---
title: "JPA/Hibernate Fundamentals - Lesson 1 Study Notes"
author: "Prepared for Beginners"
---

# ðŸ“˜ JPA/Hibernate Fundamentals 2023 - Lesson 1 (Entities)

**Instructor:** Laur Spilca  
**Video Length:** ~1 hour  
**Base YouTube Link:**  
{% assign yt = "https://www.youtube.com/watch?v=t6n1NwMM8a8" %}

---

## 1. Core Concepts

- **JPA (Jakarta Persistence API)**  
  - JPA is a **specification**, not an implementation.  
  - Defines contracts, annotations (`@Entity`, `@Id`, etc.), and interfaces (`EntityManager`, `EntityManagerFactory`).  
  - Hibernate is one of the most popular implementations.

- **ORM (Object-Relational Mapping)**  
  - Philosophy of bridging **OOP** and **relational databases**.  
  - Lets you treat database tables as Java objects.  
  - Abstracts SQL queries into object manipulation.

---

## 2. Entities

- Entities are **Java classes mapped to database tables**.  
- Must be annotated with `@Entity`.  
- Each entity requires a primary key (`@Id`).  
- Example:

```java
@Entity
public class Student {
    @Id
    private Long id;
    private String name;
    private int age;
}
```

---

## 3. Persistence Context

- Think of the **Persistence Context** as a **cache or workspace** where entities are managed.  
- Mental model:  
  - Operations (`persist`, `merge`, `remove`) act on the **context**, not directly on the database.  
  - The database is updated only when the context is **flushed** or the transaction is committed.  
- Example flow:  
  - `persist(entity)` â†’ entity is tracked in context.  
  - `commit()` â†’ SQL `INSERT` is generated.

---

## 4. Queries vs Context Operations

- Important distinction:  
  - **Context operations** (`persist`, `remove`) â†’ affect managed entities.  
  - **Queries** (`SELECT ...`) â†’ generate SQL and fetch data.  
- Mental model:  
  - Context = "in-memory representation"  
  - Queries = "instructions to database"

---

## 5. Creating `EntityManagerFactory`

There are **two main approaches**:

### Approach A: Using `Persistence.createEntityManagerFactory()`

- Requires a `persistence.xml` file in `META-INF` folder.  
- Example `persistence.xml`:

```xml
<persistence xmlns="https://jakarta.ee/xml/ns/persistence"
             version="3.0">
  <persistence-unit name="myPU">
    <provider>org.hibernate.jpa.HibernatePersistenceProvider</provider>
    <class>com.example.Student</class>
    <properties>
      <property name="jakarta.persistence.jdbc.url" value="jdbc:h2:mem:testdb"/>
      <property name="jakarta.persistence.jdbc.user" value="sa"/>
      <property name="jakarta.persistence.jdbc.driver" value="org.h2.Driver"/>
      <property name="hibernate.hbm2ddl.auto" value="update"/>
    </properties>
  </persistence-unit>
</persistence>
```

- Java code:

```java
EntityManagerFactory emf = Persistence.createEntityManagerFactory("myPU");
EntityManager em = emf.createEntityManager();
```

---

### Approach B: Using `EntityManagerFactoryBuilder` (Programmatic)

- More flexible, avoids XML.  
- Example:

```java
Map<String, Object> config = new HashMap<>();
config.put("jakarta.persistence.jdbc.url", "jdbc:h2:mem:testdb");
config.put("jakarta.persistence.jdbc.user", "sa");
config.put("jakarta.persistence.jdbc.driver", "org.h2.Driver");
config.put("hibernate.hbm2ddl.auto", "update");

EntityManagerFactory emf = new HibernatePersistenceProvider()
    .createEntityManagerFactory("myPU", config);

EntityManager em = emf.createEntityManager();
```

---

## 6. Lifecycle of Entities

- **Transient** â†’ new object, not in DB or context.  
- **Managed** â†’ tracked by context.  
- **Detached** â†’ was managed, now outside context.  
- **Removed** â†’ scheduled for deletion.

---

## 7. Key Takeaways

- JPA = specification, Hibernate = implementation.  
- Persistence Context is central: operations vs queries must be thought of differently.  
- Two ways to bootstrap `EntityManagerFactory`: XML (`persistence.xml`) or programmatic.  
- Entities are plain Java classes annotated with JPA annotations.  
- Always remember the **entity lifecycle states**.

---

## 8. Suggested Study Flow

1. Watch timestamps for **definitions**:  
   - [00:02:15]({{ yt }}&t=135s) JPA definition  
   - [00:05:40]({{ yt }}&t=340s) ORM definition  
2. Practice writing a simple `Student` entity.  
3. Try both approaches to create `EntityManagerFactory`.  
4. Experiment with persistence context operations (`persist`, `remove`, `merge`).  
5. Observe SQL generated by Hibernate to connect mental model with actual queries.

---
